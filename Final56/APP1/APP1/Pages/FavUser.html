<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8" />
    <title></title>

    <script src="../Scripts/jquery-3.4.1.min.js"></script>
    <script src="../Scripts/ajaxCalls.js"></script>
    <style>
        * {
            font-family: 'Century Gothic';
            color: darkblue;
            text-align: center;
        }

        .highlightsDiv {
            font-size: 20px;
        }

        h3 {
            text-align: center;
        }

        button {
            background-color: #4CAF50; /* Green */
            border: none;
            color: white;
            padding: 16px 32px;
            text-align: center;
            text-decoration: none;
            display: inline-block;
            font-size: 16px;
            margin: 4px 2px;
            transition-duration: 0.4s;
            cursor: pointer;
        }

        .button1 {
            background-color: white;
            color: black;
            border: 2px solid #008CBA;
        }

            .button1:hover {
                background-color: #008CBA;
                color: white;
            }
    </style>

    <script>
        var flag = 1       //1 yes 0 no
        var count = 0
        var data
        var api
        var email
        var str = "";
        var UniversityType
        var Sit
        var UniversityLevel
        var UniversitySize
        var PriceMAX = 0
        
       

        function submit1() {
            alert("in submit")
            email = "adidi@gmail.com";

            var fav = { // Note that the name of the fields must be identical to the names of the properties of the object in the server
                Email: email,
                UniversityType: $("#kindUni").val(),
                UniversitySize: $("#size").val(),
                 PriceMAX: $("#cost").val(),
                Sit: $("#SAT").val(),
                UniversityLevel: $("#division").val(),

            }
            alert("uni is: " + fav.UniversityType);

            alert(fav);
            console.log(fav)

        

           //let api = "../api/Favorites/";

           //ajaxCall("POST", api, JSON.stringify(fav), successFav, errorFav)
           //        return false;


            //-------------------------API's---------//

            if (fav.UniversityType == "") {
                alert("UniversityType NOT selected")
                $.get("https://api.data.gov/ed/collegescorecard/v1/schools.json?fields=id,school.name,school.region_id,school.state_fips,school.ownership,school.locale,school.school_url,2018.student.size,2018.cost.tuition.out_of_state,2018.admissions.sat_scores.average.overall&api_key=tcw4YqKbgv55DmuUicwNWeBtGk3XwHzoCf2SbWne", function (data) {
                    console.log(data); })}
            else {
                alert("UniversityType selected " + fav.UniversityType)
                api = "https://api.data.gov/ed/collegescorecard/v1/schools.json?school.ownership="+fav.UniversityType+"&fields=id,school.name,school.region_id,school.state_fips,school.ownership,school.locale,school.school_url,2018.student.size,2018.cost.tuition.out_of_state,2018.admissions.sat_scores.average.overall&api_key=tcw4YqKbgv55DmuUicwNWeBtGk3XwHzoCf2SbWne"
                $.get("https://api.data.gov/ed/collegescorecard/v1/schools.json?school.ownership="+fav.UniversityType+"&fields=id,school.name,school.region_id,school.state_fips,school.ownership,school.locale,school.school_url,2018.student.size,2018.cost.tuition.out_of_state,2018.admissions.sat_scores.average.overall&api_key=tcw4YqKbgv55DmuUicwNWeBtGk3XwHzoCf2SbWne", function (data) {
                    console.log(data);
                })
            }




            // Devision//

            alert("Div");

            let api = "../api/University";

            ajaxCall("GET", api, fav.UniversityLevel, successD, errorD)

                function successD(data) { alert('successD Data is: ' +data);  }

        function errorD(data) { alert('errorD') }


            



















                //function successFav(data) { alert('successFav'); }

        //function errorFav(data) { alert('errorFav') }




        function save() {

            email = localStorage.getItem('email')
            if (email) { //אם קיים אימייל
                var data = document.forms[0];
                count = 0
                for (i = 0; i < 10; i++) { //כל פעם שנלחץ לשמור נעבור על כל התכונות ונראה מי 0 מי 1
                    if (data[i].checked) {
                        api = "../api/Customer/" + data[i].value + "/" + email + "/1"; // הכנסת תכונה ליוזר מסוים
                        ajaxCall("Put", api, "", success22, error22) // put is for update title status

                    }
                    else {
                        count += 1
                        api = "../api/Customer/" + data[i].value + "/" + email + "/0"; // הסרת תכונה ליוזר מסוים
                        ajaxCall("Put", api, "", success22, error22)
                    }





                }
                alert("Your highlights saved!");
                window.open("Profile.html")
                window.close()
                return false
            }
            else {
                alert("Please login");
                window.close()
                window.open("LogIn.html")
            }

        }

      
        function success22(data) {


        }

        function error22() {

            alert("Sorry something is wrong");
            flag = 0;
            window.close()
            window.open("LogIn.html")
        }

          function showH(val) {
              //    alert(val);
                    

        }

     





       

       
            }

            </script>

</head>
<body>
    <h1 style="color:red">בחירת העדפות</h1>
    <img src="https://static.wixstatic.com/media/8e2f85_921a5cb67d12433aaa378ae195ffe667~mv2.png/v1/fill/w_446,h_63,al_c,q_85,usm_0.66_1.00_0.01/shutterstock_7439920422-11.webp" alt="logo" class="logo">

    <form>
      
        <div class="highlightsDiv">

            <label for="kindUni">סוג אוניברסיטה:</label>
            <select name="kindUni" id="kindUni" onchange="showH(this.id)">
                <option value="0">בחר סוג אוניברסיטה</option>
                <option value="1">Public</option>
                <option value="2,3">Private</option>
                <option value="1,2,3">Both</option>

            </select>

            <br /><br />

            <label for="size">גודל:</label>
            <input type="text" id="size" name="size" onchange="showH(this.value)"><br><br>


            <label for="cost">מחיר מקסימלי לשנה:</label>
            <input type="text" id="cost" name="cost" onchange="showH(this.value)"><br><br>

            <label for="SAT">ציון SAT:</label>
            <input type="text" id="SAT" name="SAT" onchange="showH(this.value)"><br><br>

             <label for="division">Devision:</label>
            <select name="division" id="division" onchange="showH(this.value)">
                <option value="0">בחר Devision</option>
                <option id="D1" value="D1">D1</option>
                <option id="D2" value="D2">D2</option>
                <option id="both" value="Both">Both</option>
            </select>

            <br /><br />

               

            <br /><br />




            <br /><br />

        </div>

        <div>
            <button type="submit" class="button button1" ONCLICK="save()">

                Save!
            </button>
            <button type="submit" class="button button1" ONCLICK="submit1()"> Submit </button>
        </div>

    </form>
</body>
</html>