<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8" />
    <title></title>
    <script src="../Scripts/ajaxCalls.js"></script>
    <script src="../Scripts/jquery-3.4.1.min.js"></script>

    <script>
        var api_data;
        var all_District
        var show_all_match
        var District
        var email
        var password
        var api_District
        var email = "adidi@gmail.com";
   
        //----District-----//

        var UsersDistrict = {
            Id: "1",
            Email: "asd",
            District: "saasd"
          
        }
        let api_Districts = "../api/UsersDistrict/"+email+"/get_all_District";
        //email = email.replace('.', '*')

            //ajaxCall("Get", api, email + "" + password, successDistrict, errorDistrict)

        ajaxCall("Get", api_Districts, "" , successDistrict, errorDistrict)

        function errorDistrict(data) {
            console.log(data);
            alert("ErrorDistrict")
        }
        function successDistrict(data) {
            console.log(data);
            if (data.length == 0 || data.length == 8 )
                api_District = "";
            else {
                api_District = "school.region_id="+ data[0].Id
                for (var i = 1; i < data.length; i++) {
                    api_District = api_District + ',' + data[i].Id
                }
                api_District = api_District + '&'
            }
            
            api_data = "https://api.data.gov/ed/collegescorecard/v1/schools.json?"+ api_District +"fields=id,school.name,school.region_id,school.state_fips,school.ownership,school.locale,school.school_url,2018.student.size,2018.cost.tuition.out_of_state,2018.admissions.sat_scores.average.overall&api_key=tcw4YqKbgv55DmuUicwNWeBtGk3XwHzoCf2SbWne"
            //function rendfav(data);

            $.get(api_data, function (data) {
                console.log(data);
                api_data = data;
                alert('District');
               
            })
        }


        //////-----State----//

        var UsersState = {
            Id: "1",
            Email: "asd",
            State: "saasd"

        }
        let api_States = "../api/UsersStates/" + email + "/get_all_States";
        //email = email.replace('.', '*')

        //ajaxCall("Get", api, email + "" + password, successDistrict, errorDistrict)

        ajaxCall("Get", api_States, "", successState, errorState)

        function errorState(data) {
            console.log(data);
            alert("ErrorDState")
        }
        function successState(data) {
            console.log(data);
            if (data.length == 0 || data.length == 57)
                api_State = "";
            else {
                api_State = "school.state_fips=" + data[0].Id
                for (var i = 1; i < data.length; i++) {
                    api_State = api_State + ',' + data[i].Id
                }
                api_State = api_State + '&'
            }

            api_data = "https://api.data.gov/ed/collegescorecard/v1/schools.json?" + api_State + "fields=id,school.name,school.region_id,school.state_fips,school.ownership,school.locale,school.school_url,2018.student.size,2018.cost.tuition.out_of_state,2018.admissions.sat_scores.average.overall&api_key=tcw4YqKbgv55DmuUicwNWeBtGk3XwHzoCf2SbWne";
            

            $.get(api_data, function (data) {
                console.log(data);
                api_data = data;
                alert('State');
                function rend(data)

            })
           
        }


        function rend(data) {
            alert("in rendfav");
            let str = ''
            for (var k = 0; k < data.length; k++) {

                //   str += "<div style:'position:relative'>" + data[k].Name + "</br ></div>";
                //  str += "<div style:'position:relative'>" + data[k].Fname + "</br ></div>";
                //  str += "<div style:'position:relative'>" + data[k].Email + "</br ></div>";
                //  str += "<div style:'position:relative'>" + data[k].Password + "</br ></div>";
                //  str += "<div style:'position:relative'>" + data[k].Phone + "</br ></div>";


                //  str += "<img src='../uploadedFiles/" + data[k].Myfile + "'/>";
                //str += '<img src="../uploadedFiles/‏'+‏data[k].Myfile + '"/>';

                //str += "<div style:'float:left'><img id='img' src='" + httpPostedFile + "' width='50px' height='60px'></div>";
                //str += "</br> img src=" + data[k].Featured_image+ "'>";
                //  str += "<div>  <button onclick='gotofav(this.id)' id='" + rlist[k].name + ' ' + rlist[k].photos_url + "'>  Add to favorites </button> rest name: " + rlist[k].name + "</div>";

            }
            document.getElementById("showfav").innerHTML = str;

        }
      

            ////-----Local----//

            //    let api = "../api/Users??/";

            //ajaxCall("Get", api, email, successLocal, errorLocal)

            //function successLocal(data) {
            //    if (data == -1)
            //        api_Local = "";
            //    else {
            //        api_Local = "school.locale=" + data + "&";
            //    }
            //    locale = data

            //    api_data = "https://api.data.gov/ed/collegescorecard/v1/schools.json?"+ api_Local+"fields=id, school.name, school.region_id, school.state_fips, school.ownership, school.locale, school.school_url, 2018.student.size, 2018.cost.tuition.out_of_state, 2018.admissions.sat_scores.average.overall & api_key=tcw4YqKbgv55DmuUicwNWeBtGk3XwHzoCf2SbWne"

            //}

            //$.get(api_data, function (data) {
            //    console.log(data);
            //    api_data = data;
            //    alert('SuccessLocale');
            //})

            //function errorState(data) { alert("ErrorLocale") }




            /////-----Fav----//


        //alert("uni level: " + UniversityLevel)
        //alert("uni level: " + fav.UniversityType)
        //let api_Fav = "../api/Favorites/" + UniversityLevel;
        //ajaxCall("Get", api_Fav, email, successFav, errorFav)

        //function errorState(data) {
        //    console.log(data);
        //    alert("ErrorFav")
        //}
        //function successState(data) {
        //    console.log(data);
        //    alert(data);

        

            //if (data.length == 0 || data.length == 57)
            //    api_State = "";
            //else {
            //    api_State = "school.state_fips=" + data[0].Id
            //    for (var i = 1; i < data.length; i++) {
            //        api_State = api_State + ',' + data[i].Id
            //    }
            //    api_State = api_State + '&'
           /* }*/

            //api_data = "https://api.data.gov/ed/collegescorecard/v1/schools.json?" + api_State + "fields=id,school.name,school.region_id,school.state_fips,school.ownership,school.locale,school.school_url,2018.student.size,2018.cost.tuition.out_of_state,2018.admissions.sat_scores.average.overall&api_key=tcw4YqKbgv55DmuUicwNWeBtGk3XwHzoCf2SbWne"

            //$.get(api_data, function (data) {
            //    console.log(data);
            //    api_data = data;
            //    alert('State');
            //})
        /*}*/

            //// "select * from UsersFavorites where UniversitySize <="+ UniversitySize+ "and UniversityLevel =" +UniversityLevel+ "and
            ////PriceMAX <= "+ PriceMAX +"and UniversityType = "+UniversityType+ "and Sit <= " +Sit;

        
         


    </script>
   
</head>
<body>
    <div id="showfav"> </div>
</body>
</html>